
SCHEMA >
    `DOCUMENTO` Nullable(String),
    `MET_GEST_NO_CRITICAS` Nullable(Int64),
    `MET_GEST_CRIT_ALTA` Nullable(Int64),
    `MET_GEST_CRIT_MUYALTA` Nullable(Int64),
    `MET_CANT_GEST_NULL` Nullable(Int64),
    `FECHA_MAX_NO_CRITICA` Nullable(Int64),
    `FECHA_MAX_CRITICA_ALTA` Nullable(Int64),
    `FECHA_MAX_CRITICA_MUY_ALTA` Nullable(Int64),
    `SEGMENTO_RENTABILIDAD` Nullable(String),
    `SEGMENTO_CRITICIDAD_FECHA` Nullable(String),
    `SEGMENTO_CRITICIDAD_CANTIDAD` Nullable(String),
    `CLASIFICACION_CUHD` Nullable(String),
    `DECIL_RENTABILIDAD` Nullable(Int64),
    `AVG_RENTABILIDAD` Nullable(Float64),
    `MET_RECLAMOS_TC` Nullable(String),
    `MET_RECLAMOS_TDIGITAL` Nullable(String),
    `PRIORIDAD` Nullable(Int64),
    `FECHA_PROCESAMIENTO` Nullable(Int64),
    `PRIORIDAD_CUANTIL` Nullable(Int64),
    `insertion_date` DateTime DEFAULT now()

ENGINE "MergeTree"
ENGINE_PARTITION_KEY "toYear(insertion_date)"
ENGINE_SORTING_KEY "insertion_date"

IMPORT_SERVICE 'snowflake'
IMPORT_CONNECTION_NAME 'tinybird_snowflake_2023'
IMPORT_EXTERNAL_DATASOURCE 'DB_TINYBIRD_TEST.PUBLIC.TB_NARANJA_AR_MODELO_CANALES_ATENCIONDIFERENCIADA_TINY'
IMPORT_STRATEGY 'replace'
IMPORT_QUERY 'SELECT CAST(DOCUMENTO AS STRING) AS DOCUMENTO, MET_GEST_NO_CRITICAS, MET_GEST_CRIT_ALTA, MET_GEST_CRIT_MUYALTA, MET_CANT_GEST_NULL, FECHA_MAX_NO_CRITICA, FECHA_MAX_CRITICA_ALTA, FECHA_MAX_CRITICA_MUY_ALTA, CAST(SEGMENTO_RENTABILIDAD AS STRING) AS SEGMENTO_RENTABILIDAD, CAST(SEGMENTO_CRITICIDAD_FECHA AS STRING) AS SEGMENTO_CRITICIDAD_FECHA, SEGMENTO_CRITICIDAD_CANTIDAD, CAST(CLASIFICACION_CUHD AS STRING) AS CLASIFICACION_CUHD, DECIL_RENTABILIDAD, AVG_RENTABILIDAD, MET_RECLAMOS_TC, MET_RECLAMOS_TDIGITAL, PRIORIDAD, FECHA_PROCESAMIENTO, PRIORIDAD_CUANTIL FROM DB_TINYBIRD_TEST.PUBLIC.TB_NARANJA_AR_MODELO_CANALES_ATENCIONDIFERENCIADA_TINY'
IMPORT_SCHEDULE '@on-demand'
